{# src/site/_includes/components/user/common/header/wiki-card.njk #}

{% set cardTitle = title or page.fileSlug or 'Nota sin t√≠tulo' %}

{# 
    CLAVE: Llama a la funci√≥n buscadora, que usa el slug para encontrar la nota en las colecciones.
#}
{% set noteData = noteFinder.getFrontmatter(page.fileSlug) %}

{% set displayedProperties = [] %}

<aside class="wiki-card-container" style="/* ... estilos ... */">
    
    <div class="wiki-card-header">
        <h3>DEBUG: RESULTADO FINAL</h3>
    </div>
    
    <div class="wiki-card-content">
        <p>T√≠tulo: **{{ cardTitle }}**</p>
        
        <hr>
        
        {% if noteData and noteData.estado %}
            <p style="color: green; font-weight: bold;">üéâ ¬°√âXITO! FRONTMATTER ENCONTRADO.</p>
            <p>Valor de 'estado': <span style="background-color: yellow;">{{ noteData.estado or 'N/A' }}</span></p>
            <p>Propiedades relevantes:</p>
            <table class="wiki-card-properties">
                <tr><td>Estado:</td><td>{{ noteData.estado or 'N/A' }}</td></tr>
                <tr><td>Tipo Contenido:</td><td>{{ noteData.tipo_contenido or 'N/A' }}</td></tr>
            </table>
            
        {% else %}
            <p style="color: red; font-weight: bold;">‚ùå FALLO DEFINITIVO: La b√∫squeda no encontr√≥ las propiedades locales.</p>
            <p>Debug de la herramienta (noteFinder): {{ noteFinder | dump(1) }}</p>
        {% endif %}
    </div>
</aside>
